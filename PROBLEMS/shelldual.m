%----------------------------
% Function shell dual
%----------------------------
function y = shelldual(x)
    A = [-16 2 0 1 0;
           0 -2 0 4 2;
           -3.5 0 2 0 0;
           0 -2 0 -4 -1;
           0 -9 -2 1 -2.8;
           2 0 -4 0 0;
           -1 -1 -1 -1 -1;
           -1 -2 -3 -2 -1;
           1 2 3 4 5;
           1 1 1 1 1;
        ];
    b = [-40; -2; -0.25; -4.0; -4.0; -1.0; -40.0; -60.0; 5.0; 1.0];
    C = [30 -20 -10 32 -10;
        -20 39 -6 -31 32;
        -10 -6 10 -6 -10;
        32 -31 -6 39 -20;
        -10 32 -10 -20 30];
    d = [4; 8; 10; 6; 2];
    e = [-15 -27 -36 -18 -12];

    P = A'*x(1:10) - 2*C*x(11:15) - 3*d.*x(11:15) - e';
    Q = sum(min(0,x));
    
    %keyboard
    y = x(11:15)'*C*x(11:15) + 2*abs(sum(d.*x(11:15).^3)) - b'*x(1:10) + ...
        100*(sum(max(0,P)) - Q);
end